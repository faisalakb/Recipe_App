<!DOCTYPE html>
<html>
  <head>
    <title>RecipeApp</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag "nav", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <%= stylesheet_link_tag "modal", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <%= stylesheet_link_tag "missing-food", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <%= stylesheet_link_tag "register", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <%= javascript_include_tag 'rails-ujs' %>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  </head>

  <body>
    <% if user_signed_in? %>
      <nav class="nav-container">
        <p class="user">Welcome, <%= current_user.name %></p>
        <ul>
          <li><a href="/" data-turbolinks-track="true">Foods</a></li>
          <li><a href="/recipes" data-turbolinks-track="true">Recipes</a></li>
          <li><a href="/public_recipes" data-turbolinks-track="true">Public Recipes</a></li>
          <li><a href="/inventories" data-turbolinks-track="true">Inventories</a></li>
          <li><a href="/inventories_shopping_list" data-turbolinks-track="true">Inventories Shopping List</a></li>
          <li><a href="/missing_foods" data-turbolinks-track="true">Food Shopping List</a></li>
        </ul>
      </nav>
    <% end %>

    <p class="notice"><%= notice %></p>
    <p class="alert"><%= alert %></p>

    <%= yield %>

    <script>
      $(document).ready(function() {
        $(".sortable").click(function() {
          var table = $(this).closest("table");
          var rows = table.find("tbody > tr").get();

          var ascending = $(this).hasClass("asc");
          $(this).toggleClass("asc desc");

          var columnIndex = $(this).index(); // Get the index of the clicked column header

          rows.sort(function(a, b) {
            var aValue = $(a).find("td").eq(columnIndex).text(); // Get the value of the corresponding column in row a
          var bValue = $(b).find("td").eq(columnIndex).text(); // Get the value of the corresponding column in row b
            return ascending ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
          });

          table.children("tbody").empty().append(rows);
        });
        // Set default sort class
        $(".sortable").first().addClass("asc");
      });
    </script>
  </body>
</html>
